Similar to the previous version but also handles hard removal
